# Элемент для оплаты через Яндекс.Кассу (API)

Элемент для JBZoo 2.2.x для оплаты через Яндекс.Кассу (если ваш магазин - юр.лицо) с полной интеграцией.
Т.е. при оплате будет меняться статус заказа и сайт отправит почту/sms.

Скачать последнюю версию можно [тут](https://github.com/JBZoo/Element-Payment-YandexKassa/archive/master.zip)


#### Внимание!
Это бета-версия, которая тестировалась на JBZoo v2.2.7 и песочнице http://demomoney.yandex.ru

Элемент должен быть совместим с любой стабильной версией 2.2.x


#### Установка
Распаковать архив в папку с элементами оплаты `/media/zoo/applications/jbuniversal/cart-elements/payment/yandexkassa`
так, чтобы в указанной папке был файл `yandexkassa.php`

CheckURL и AvisoURL один и тот же - `http://<__ВАШ_ДОМЕН__>/index.php?option=com_zoo&controller=payment&task=paymentCallback`

Элемент проверяет оплату [через md5](https://tech.yandex.ru/money/doc/payment-solution/payment-notifications/payment-notifications-http-docpage/)

Пароль, номер магазина и витрины будут выданы при заключении договора с Яндекс.Кассой


#### Элемент для интеграции с уведомлением о платежах по Email
https://github.com/JBZoo/Element-Payment-YandexKassa-Email


#### Баги? Вопросы?
По всем вопросам обращайтесь в нашу поддержку на форум [Forum.JBZoo.com](http://forum.jbzoo.com/)


#### Лицензия
MIT



## Информация от Яндекса
*Текст ниже актуален после заключения договора и скорее всего придет к вам на почту от менеджера или тех.отдела*

Проверьте, чтобы ваши CheckURL и AvisoURL были доступны по **https** (нужен самоподписной или платный SSL сертификат).

### Настройки магазина

`shopId` (идентификатор магазина) = будет выдан после подписания договора

`scid` (номер витрины) = будет выдан после подписания договора

`password` (пароль API) = будет выдан после подписания договора / можно указать свой из 20 символов при заключении договора



### Тестирование

**карточный платеж (AC)**

Как только вы настроите свой сайт для тестирования, выполните тестовый платеж кошельком или тестовой картой (это самый простой тест и его достаточно, чтобы проверить корректность работы):
* при оплате выберите "Карточный платеж" (paymentType=AC)
* тестовая карта: 4444 4444 4444 4448, cvv 000 (действует до: любая дата в будущем)


**платеж демо кошельком (PC)**

если не получилось картой (метод может быть вам не подключен), проверьте кошельком.
Сделайте себе свой тестовый кошелек за 1 минуту. Пройдите по ссылке https://demomoney.yandex.ru/reg/ (важный момент: вы сможете сделать себе быстро тестовый кошелек, если у вас уже есть учетная запись в яндекс; если ее нет, то ее надо сделать, чтобы затем получить персональный тестовый кошелек). Чтобы пополнить тестовый кошелек, перейдите по ссылке https://demomoney.yandex.ru/shop.xml?scid=50215, введите номер своего кошелька и сумму. Номер кошелька можно узнать нажав на кнопке кошелька в верхнем правом углу экрана.

После того, как вы выполните тестирование, напишите ответ на текущее письмо. Будьте уверены: если тестирование работает хотя бы одним методом. значит работают и другие методы, поэтому другие методы проверять не нужно.



#### Документация

* Документация: https://money.yandex.ru/doc.xml?id=527069
* Примеры на php: https://github.com/YandexMoney/yandexmoney/tree/master/Yandex.Kassa/example%20integration/php
(вам нужны checkOrder.php, paymentAviso.php).

